---
title: "Title of Your Submission"
shorttitle: "Short Title"
leftheader: "VISC Report"
from:
 - name: FirstNameA LastNameA
   email: foo@bar.com
   contact: true
 - name: FirstNameB LastNameB
to:
 - name: FirstNameA LastNameA
dropcc: false
cc:
 - name: FirstNameA LastNameA
includesummary: true
summary: 
  A short summary about your report. 
bibliography: "`r ifelse(file.exists('bibliography.bib'), 'bibliography.bib', rprojroot::find_rstudio_root_file('docs', 'bibliography.bib'))`"
lof: true
lot: true
toc: true
dropVISClogo: false
output: 
  VISCtemplates::visc_pdf_document: default
  VISCtemplates::visc_word_document: default
---

<!---
Program Name:
Creation Date:
Full name of author:
Project or Protocol:
Purpose or description of program:
Location of program:
Location of input data:
--->

```{r package-loading-and-options, include=FALSE}
library(VISCtemplates)
library(VISCfunctions)

check_pandoc_version()

packages_needed <- c("conflicted", "tidyverse", "knitr", "flextable")

install_load_cran_packages(packages_needed)

# knitr options
opts_chunk$set(cache = FALSE, message = TRUE, warning = TRUE, echo = FALSE, 
               dev = c("png", "pdf"), dpi = 200, out.width = '100%', 
               out.extra = '', fig.pos = "H")
# fig.align argument is not supported in Word (align in template docx)
if (knitr::opts_knit$get('rmarkdown.pandoc.to') == 'latex'){
  opts_chunk$set(fig.align = "center")
}

# Table settings
set_flextable_defaults(na_str = "", # NA's will be blank in tables
                       font.size = 8,
                       theme_fun = "theme_vanilla",
                       table.layout = "autofit",
                       digits = 3,
                       fonts_ignore = TRUE)

# Create a theme 
visc_theme <- theme_bw() + 
  theme(
    legend.position = "bottom", 
    legend.margin = margin(unit = "cm"),
    panel.grid.minor = element_blank()
    )

theme_set(visc_theme)

# Set group colors for this example.
# If you have group colors already in your project:
# source(rprojroot::find_rstudio_root_file("docs", "group-colors.R"), local = TRUE)
group_colors <- c(
  `1` = "#D92321",
  `2` = "#1749FF",
  `4` = "#0AB7C9"
)
```

```{r conflicted-preferences, message=FALSE}

# filter() is used in both dplyr and stats, so need to set the preference to dplyr
conflict_prefer("filter", "dplyr")
```

# Section Header

Add some text here

## Subsection Header

Add some text here

\newpage

# Reproducibility Software Information

```{r, results="asis"}

label <- "Software-Session-Information"
caption <- "Reproducibility software session information"

# load in rmarkdown to capture version number
if (any(installed.packages()[,1] == 'rmarkdown')) suppressWarnings(library(rmarkdown))

my_session_info <- VISCfunctions::get_session_info()

flextable(my_session_info$platform_table) %>%
  set_caption(caption,
              autonum = officer::run_autonum(seq_id = "tab", bkm = label))
```

\newpage

```{r, results="asis"}

label <- "Software-Package-Version-Information"
caption <- "Reproducibility software package version information"

flextable(my_session_info$packages_table) %>%
  set_caption(caption,
              autonum = officer::run_autonum(seq_id = "tab", bkm = label))
```

\newpage

`r insert_references_section_header()`
