---
title: "Title of Your Submission"
shorttitle: "Short Title"
leftheader: "VISC Report"
from:
 - name: FirstNameA LastNameA
   email: foo@bar.com
   contact: true
 - name: FirstNameB LastNameB
to:
 - name: FirstNameA LastNameA
dropcc: false
cc:
 - name: FirstNameA LastNameA
includesummary: true
summary: 
  A short summary about your report. 
bibliography: "`r ifelse(file.exists('bibliography.bib'), 'bibliography.bib', rprojroot::find_rstudio_root_file('docs', 'bibliography.bib'))`"
lof: true
lot: true
toc: true
dropVISClogo: false
output: 
  VISCtemplates::visc_pdf_document: default
  VISCtemplates::visc_word_document: default
---

<!---
Program Name:
Creation Date:
Full name of author:
Project or Protocol:
Purpose or description of program:
Location of program:
Location of input data:
--->

```{r package-loading-and-options, include=FALSE}
library(VISCtemplates)
library(VISCfunctions)

check_pandoc_version()

packages_needed <- c("conflicted", "tidyverse", "knitr", "kableExtra")

install_load_cran_packages(packages_needed)

# knitr options
opts_chunk$set(cache = FALSE, message = TRUE, warning = TRUE, echo = FALSE, 
               dev = c("png", "pdf"), dpi = 200, out.width = '100%', 
               out.extra = '', fig.align = "center", fig.pos = "H")

# table settings
options(knitr.kable.NA = '') # NA's will be blank in tables
flextable::set_flextable_defaults(na_str = "", # NA's will be blank in tables
                                  font.size = 8,
                                  theme_fun = "theme_box",
                                  table.layout = "autofit",
                                  digits = 3)

# Create a theme 
visc_theme <- theme_bw() + 
  theme(
    legend.position = "bottom", 
    legend.margin = margin(unit = "cm"),
    panel.grid.minor = element_blank()
    )

theme_set(visc_theme)

# Set group colors for this example.
# If you have group colors already in your project:
# source(rprojroot::find_rstudio_root_file("docs", "group-colors.R"))
group_colors <- c(
  `1` = "#D92321",
  `2` = "#1749FF",
  `4` = "#0AB7C9"
)
```

```{r conflicted-preferences, message=FALSE}

# filter() is used in both dplyr and stats, so need to set the preference to dplyr
conflict_prefer("filter", "dplyr")
```

```{r word-pdf-options}

output_type <- get_output_type()

kable_warnings <- set_kable_warnings(output_type)
pandoc_markup <- set_pandoc_markup(output_type)
```

# Section Header

Add some text here

## Subsection Header

Add some text here

`r insert_break()` 

# Reproducibility Software Information

```{r Software-Session-Information, results="asis", message=FALSE, warning=kable_warnings}

# load in rmarkdown to capture version number
if (any(installed.packages()[,1] == 'rmarkdown')) suppressWarnings(library(rmarkdown))

my_session_info <- VISCfunctions::get_session_info()

print_visc_table(my_session_info$platform_table,
                 "Reproducibility software session information")
```

```{r Software-Package-Version-Information, results="asis", warning=kable_warnings}

pkgs_tbl <- my_session_info$packages_table %>%
  separate_wider_delim(source, delim = "@", names = c("source1", "source2"),
                       too_few = "align_start") %>%
  mutate(source = if_else(
    is.na(source2),
    source1,
    paste0(source1, "@", str_sub(source2, 1, 7), ")") # truncates git hashes
  )) %>%
  select(-source1, -source2)

print_visc_table(pkgs_tbl, 
                 "Reproducibility software package version information")
```

`r insert_break()` 

`r insert_references_section_header()`
