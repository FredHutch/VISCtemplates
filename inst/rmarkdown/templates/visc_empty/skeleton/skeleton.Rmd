---
title: "Title of Your Submission"
shorttitle: "Short Title"
leftheader: "VISC Report"
author: "Contact: First Name, Last Name (xxx@fredhutch.org)"
date: "Word document compiled on `r format(Sys.Date(), '%A, %B %d, %Y')`"
from:
 - name: FirstNameA LastNameA
   email: foo@bar.com
   contact: true
 - name: FirstNameB LastNameB
to:
 - name: FirstNameC LastNameC
 - name: FirstNameD LastNameD
dropcc: false
cc:
 - name: FirstNameE LastNameE
 - name: FirstNameF LastNameF
includesummary: true
summary: 
  A short summary about your report. 
bibliography: "`r ifelse(file.exists('bibliography.bib'), 'bibliography.bib', rprojroot::find_rstudio_root_file('docs', 'bibliography.bib'))`"
lof: true
lot: true
toc: true
dropVISClogo: false
output: 
  VISCtemplates::visc_pdf_document: default
  VISCtemplates::visc_word_document: default
---

<!---
This section is required according to WI-0010.
Program Name:
Creation Date:
Full name of author:
Project or Protocol:
Purpose or description of program:
Location of program:
Location of input data:
--->

```{r package-loading-and-options, include=FALSE}

# packages installed from GitHub
library(VISCtemplates)
library(VISCfunctions)

check_pandoc_version()

# packages installed from CRAN
packages_needed <- c("conflicted", "dplyr", "ggplot2", "knitr", "kableExtra", "flextable", "rprojroot")
install_load_cran_packages(packages_needed)

# knitr options
opts_chunk$set(cache = FALSE,
               message = TRUE,
               warning = TRUE,
               echo = FALSE, 
               dev = c("png", "pdf"),
               dpi = 200,
               out.width = "100%", 
               out.extra = "",
               fig.pos = "H")
# fig.align argument is not supported in Word (align in template docx)
if (get_output_type() == 'latex'){
  opts_chunk$set(fig.align = "center")
}

# table options
options(knitr.kable.NA = '') # NA's will be blank in kable tables
set_flextable_defaults(na_str = "",
                       font.size = 10,
                       theme_fun = "theme_box",
                       table.layout = "autofit",
                       fonts_ignore = TRUE,
                       digits = 3)

# Create a ggplot theme for consistency of figures
visc_theme <- theme_bw() + 
  theme(legend.position = "bottom", 
        legend.margin = margin(unit = "cm"),
        panel.grid.minor = element_blank())
theme_set(visc_theme)
```

```{r conflicted-preferences, message=FALSE}

# filter() is used in both dplyr and stats, so need to set the preference to dplyr
conflict_prefer("filter", "dplyr")
```

```{r word-pdf-options}

output_type <- get_output_type()

kable_warnings <- set_kable_warnings(output_type)
pandoc_markup <- set_pandoc_markup(output_type)
```

```{r read-data}

# Read in your data in this chunk

```

```{r data-processing}

# Do your data processing in this chunk

```

\newpage

# Section Header

Add some text here

## Subsection Header

Add some text here

`r insert_break()`

# Reproducibility Software Information

```{r Software-Session-Information, results="asis", message=FALSE, warning=kable_warnings}
# load in rmarkdown to capture verison number
if (any(installed.packages()[,1] == 'rmarkdown')) suppressWarnings(library(rmarkdown))

my_session_info <- VISCfunctions::get_session_info()

kable(
  my_session_info$platform_table, 
  format = output_type, 
  booktabs = TRUE, 
  linesep = "", 
  caption = "Reproducibility software session information"
  ) %>% 
  kable_styling(font_size = 10, latex_options = "hold_position")
```

```{r Software-Session-Information-flextable, results="asis", eval=(output_type != 'latex')}
# same table, but using flextable instead of kable for Word output
flextable(my_session_info$platform_table) %>%
  set_caption("Reproducibility software session information")
```

```{r Software-Package-Version-Information, results="asis", warning=kable_warnings}

kable(
  my_session_info$packages_table, 
  format = output_type,
  booktabs = TRUE, 
  linesep = "", 
  caption = "Reproducibility software package version information"
  ) %>% 
  kable_styling(font_size = 10, latex_options = "hold_position")
```

```{r Software-Package-Version-Information-flextable, results="asis", eval=(output_type != 'latex')}
# same table, but using flextable instead of kable for Word output
flextable(my_session_info$packages_table) %>%
  set_caption("Reproducibility software package version information")
```

`r insert_break()`

# Acknowledgements

Include your acknowledgements in this section.

\newpage

`r insert_references_section_header()`
