---
title: "Title of Your Submission"
shorttitle: "Short Title"
leftheader: "VISC Report"
from:
 - name: FirstNameA LastNameA
   email: foo@bar.com
   contact: true
 - name: FirstNameB LastNameB
to:
 - name: FirstNameC LastNameC
 - name: FirstNameD LastNameD
dropcc: false
cc:
 - name: FirstNameE LastNameE
 - name: FirstNameF LastNameF
includesummary: true
summary: 
  A short summary about your report. 
bibliography: "`r ifelse(file.exists('bibliography.bib'), 'bibliography.bib', rprojroot::find_rstudio_root_file('docs', 'bibliography.bib'))`"
lof: true
lot: true
toc: true
dropVISClogo: false
output: 
  VISCtemplates::visc_pdf_document: default
  VISCtemplates::visc_word_document: default
---

<!---
This section is required according to WI-0010.
Program Name:
Creation Date:
Full name of author:
Project or Protocol:
Purpose or description of program:
Location of program:
Location of input data:
--->

```{r package-loading-and-options, include=FALSE}

# packages installed from GitHub
library(VISCtemplates)
library(VISCfunctions)

check_pandoc_version()

# packages installed from CRAN
packages_needed <- c("conflicted", "dplyr", "knitr", "flextable", "rprojroot")
install_load_cran_packages(packages_needed)

# knitr options
opts_chunk$set(cache = FALSE,
               message = TRUE,
               warning = TRUE,
               echo = FALSE, 
               dev = c("png", "pdf"),
               dpi = 200,
               out.width = "100%", 
               out.extra = "",
               fig.pos = "H")
# fig.align argument is not supported in Word (align in template docx)
if (knitr::opts_knit$get('rmarkdown.pandoc.to') == 'latex'){
  opts_chunk$set(fig.align = "center")
}

# Table settings
set_flextable_defaults(na_str = "", # NA's will be blank in tables
                       font.size = 8,
                       theme_fun = "theme_vanilla",
                       table.layout = "autofit",
                       digits = 3,
                       fonts_ignore = TRUE)
add_caption_and_label <- function(x, caption, label) {
  set_caption(x,
              caption = caption,
              autonum = officer::run_autonum(seq_id = "tab", bkm = label))
}

# Create a ggplot theme for consistency of figures
visc_theme <- theme_bw() + 
  theme(legend.position = "bottom", 
        legend.margin = margin(unit = "cm"),
        panel.grid.minor = element_blank())
theme_set(visc_theme)
```

```{r conflicted-preferences, message=FALSE}

# filter() is used in both dplyr and stats, so need to set the preference to dplyr
conflict_prefer("filter", "dplyr")
```

```{r read-data}

# Read in your data in this chunk

```

```{r data-processing}

# Do your data processing in this chunk

```

\newpage

# Section Header

Add some text here

## Subsection Header

Add some text here

\newpage

# Reproducibility Software Information

```{r, results="asis"}

label <- "Software-Session-Information"
caption <- "Reproducibility software session information"

# load in rmarkdown to capture version number
if (any(installed.packages()[,1] == 'rmarkdown')) suppressWarnings(library(rmarkdown))

my_session_info <- VISCfunctions::get_session_info()

flextable(my_session_info$platform_table) %>%
  add_caption_and_label(caption, label)
```

\newpage

```{r, results="asis"}

label <- "Software-Package-Version-Information"
caption <- "Reproducibility software package version information"

flextable(my_session_info$packages_table) %>%
  add_caption_and_label(caption, label)
```

\newpage

# Acknowledgements

Include your acknowledgements in this section.

\newpage

`r insert_references_section_header()`
